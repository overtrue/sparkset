echo "ğŸ” Running pre-commit validation..."

# è¿è¡Œ lint-stagedï¼ˆæ ¼å¼åŒ–ã€lintï¼‰
pnpm lint-staged || {
  echo "âŒ Pre-commit validation failed. Please fix the errors before committing."
  exit 1
}

# å¦‚æœæœ‰ server ç›¸å…³çš„æ–‡ä»¶ä¿®æ”¹ï¼Œè¿è¡Œç±»å‹æ£€æŸ¥
if git diff --cached --name-only | grep -q "apps/server/.*\.ts"; then
  echo "ğŸ” Running type check for server..."
  pnpm --filter @sparkset/server typecheck || {
    echo "âŒ Type check failed. Please fix the type errors before committing."
    exit 1
  }
fi

echo "âœ… Pre-commit validation passed!"
